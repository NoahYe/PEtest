apply(cons000300[-1,], 1,func_renamestock)
apply(cons000300, 1,func_renamestock)
View(cons000300)
apply(cons000300, 2,func_renamestock)
View(cons000300)
cons000300<-read.csv('000300cons.csv',header=T)
View(cons000300)
typeof(cons-000300[,4])
typeof(cons000300[,4])
typeof(cons000300[,3])
typeof(cons000300[,2])
typeof(cons000300[,])
typeof(cons000300[1,4])
cons000300[1,4]
cons000300[1,4].levels
cons000300[1,4]$level
typeof(000300conscode)
typeof(conscode000300)
typeof(cons000300)
cons000300[1]
cons000300[4]
cons000300[4,1]
cons000300[4,4]
cons000300[4,4]
cons000300[4,300]
cons000300[4,299]
cons000300[4,3]
cons000300[4,2]
cons000300[,1]
cons000300[,2]
cons000300[,3]
cons000300[,4]
cons000300[,4][1]
cons000300[,4][100]
cons000300[,4][200]
class(cons000300)
apply(cons000300,1,func_renamestock)
View(cons000300)
debugSource('~/R_in_action/sina/rename.r')
apply(cons000300,1,func_renamestock)
apply(cons000300,1,func_renamestock[cons000300])
test <- cons000300[1,]
test
func_renamestock(test)
test
func_renamestock(test)
View(stock_row)
View(stock_row)
View(stock_row)
func_renamestock(test)
test
test<-func_renamestock(test)
test
test<-func_renamestock(test)
test<-cons000300[1,]
test
test<-func_renamestock(test)
test
test<-func_renamestock(test)
test<-cons000300[1,]
test
debugSource('~/R_in_action/sina/rename.r')
func_renamestock(test)
func_renamestock(test)
View(stock_row)
View(stock_row)
func_renamestock(test)
func_renamestock(test)
func_renamestock(test)
func_renamestock(test)
debugSource('~/R_in_action/sina/rename.r')
debugSource('~/R_in_action/sina/rename.r')
debugSource('~/R_in_action/sina/rename.r')
func_renamestock(test)
View(stock_row)
View(stock_row)
stock
stock_row
func_renamestock(test)
debugSource('~/R_in_action/sina/rename.r')
func_renamestock(test)
debugSource('~/R_in_action/sina/rename.r')
func_renamestock(test)
apply(cons000300,1,func_renamestock)
apply(cons000300,1,func_renamestock)
cons000300
View(cons000300)
apply(cons000300,1,func_renamestock)
cons000300<-apply(cons000300,1,func_renamestock)
View(cons000300)
cons000300<-read.csv('000300cons.csv',header=T)
View(cons000300)
cons000300[,5]<-read.csv('000300cons.csv',header=T)
cons000300[,5]<-apply(cons000300,1,func_renamestock)
View(cons000300)
cons000300<-read.csv('000300cons.csv',header=T)
cons000300 <- cbind(cons000300,apply(cons000300,1,func_renamestock))
View(cons000300)
test2<-apply(cons000300,1,func_renamestock)
View(test2)
source('~/R_in_action/sina/rename.r')
cons000300<-read.csv('000300cons.csv',header=T)
debugSource('~/R_in_action/sina/rename.r')
test2<-apply(cons000300,1,func_renamestock)
debugSource('~/R_in_action/sina/rename.r')
debugSource('~/R_in_action/sina/rename.r')
test2<-apply(cons000300,1,func_renamestock)
test2<-apply(cons000300,1,func_renamestock)
test2<-apply(cons000300,1,func_renamestock)
test2
View(test2)
cons000300<-read.csv('000300cons.csv',header=T)
test2<-cons000300[1,]
test2
debugSource('~/R_in_action/sina/rename.r')
function(test2)
}
func_renamestock(test2)
View(stock_row)
View(stock_row)
View(stock_row)
View(stock_row)
View(stock_row)
View(test2)
test2<-func_renamestock(test2)
test2
rbind(test2,apply(cons000300,1,func_renamestock))
apply(cons000300,1,func_renamestock)
View(apply(cons000300,1,func_renamestock))
t(apply(cons000300,1,func_renamestock))
View(t(apply(cons000300,1,func_renamestock)))
stock_list<-t(apply(cons000300,1,func_renamestock))
View(stock_list)
stock_list<-stock_list[,5]
View(stock_list)
typeof(stock_list[1])
for(name in stock_list){
url<-paste(url,name,sep=',')}
stock_list
url
stockurl
stockurl<-NA
stockurl
stockurl<-paste(stockurl,stock_list[1],sep=',')}
stockurl<-paste(stockurl,stock_list[1],sep=',')
stockurl
stockurl<-''
stockurl<-paste(stockurl,stock_list[1],sep=',')
stockurl
stockurl<-stock_list[1]
stockurl
source('~/R_in_action/sina/rename.r')
stock_list<-t(apply(cons000300,1,func_renamestock))
stock_list
stock_list
stock_list
stock_list<-t(apply(cons000300,1,func_renamestock))
stock_list
debugSource('~/R_in_action/sina/rename.r')
stock_list<-t(apply(cons000300,1,func_renamestock))
stock_list<-t(apply(cons000300,1,func_renamestock))
View(stock_list)
debugSource('~/R_in_action/sina/rename.r')
stock_list<-t(apply(cons000300,1,func_renamestock))
write.csv(stock_list,file = "Update20131216.csv",row.names = FALSE)
View(cons000300)
apply(cons000300,1,func_renamestock)
test<- cons000300[1:3,]
apply(test,1,func_renamestock)
t(apply(test,1,func_renamestock))
View(t(apply(test,1,func_renamestock)))
View(t(apply(cons000300,1,func_renamestock)))
View(t(apply(cons000300[1:10,],1,func_renamestock)))
View(t(apply(cons000300[1:5,],1,func_renamestock)))
View(t(apply(cons000300[1:3,],1,func_renamestock)))
View(t(apply(cons000300[1:20,],1,func_renamestock)))
View(t(apply(cons000300[1:30,],1,func_renamestock)))
View(t(apply(cons000300[1:100,],1,func_renamestock)))
View(t(apply(cons000300[4,],1,func_renamestock)))
View(t(apply(cons000300[10,],1,func_renamestock)))
View(t(apply(cons000300[10,],1,func_renamestock)))
View(cons000300)
View(t(apply(cons000300[1],1,func_renamestock)))
View(t(apply(cons000300[1,],1,func_renamestock)))
View(t(apply(cons000300[3,],1,func_renamestock)))
View(t(apply(cons000300[3,],1,func_renamestock)))
View(t(apply(cons000300[1:3,],1,func_renamestock)))
View(t(apply(cons000300[1:10,],1,func_renamestock)))
View(t(apply(cons000300[1:200,],1,func_renamestock)))
View(t(apply(cons000300[1:100,],1,func_renamestock)))
View(t(apply(cons000300[1:100,],1,func_renamestock)))
View(t(apply(cons000300[1:80,],1,func_renamestock)))
View(t(apply(cons000300[1:50,],1,func_renamestock)))
View(t(apply(cons000300[1:650,],1,func_renamestock)))
View(t(apply(cons000300[1:65,],1,func_renamestock)))
View(t(apply(cons000300[1:60,],1,func_renamestock)))
View(t(apply(cons000300[1:70,],1,func_renamestock)))
View(t(apply(cons000300[1:68,],1,func_renamestock)))
View(t(apply(cons000300[1:66,],1,func_renamestock)))
View(t(apply(cons000300[1:65,],1,func_renamestock)))
cons000300<-read.csv('000300cons.csv',header=T,colClass=character)
cons000300<-read.csv('000300cons.csv',header=T,colClasses=character)
cons000300<-read.csv('000300cons.csv',header=T,colClasses=Character)
cons000300<-read.csv('000300cons.csv',header=T,colClasses=double)
cons000300<-read.csv('000300cons.csv',header=T)
cons000300<-read.csv('000300cons.csv',header=T,colClasses='character')
View(cons000300)
cons000300<-read.csv('000300cons.csv',header=T)
cons000300
nchar(cons000300[1,])
nchar(cons000300[,1])
6-nchar(cons000300[,1])
x<- rep('0',6-nchar(cons000300[,1]))
x<- rep('0',6)
x
x<- rep('0',(6-nchar(cons000300[,1]))
}
x<- rep('0',(6-nchar(cons000300[,1])))
substr('000000',start=1,stop=(6-nchar(cons000300[,1])))
rep('000000',nrow(cons000300))
x<-rep('000000',nrow(cons000300))
substr(x,,start=1,stop=(6-nchar(cons000300[,1])))
substr(x,start=1,stop=(6-nchar(cons000300[,1])))
cons000300
cons000300[,1]
y<-paste(cons000300[,1],x)
View(y)
y<-paste(cons000300[,1],x,sep='')
y
x
x<-substr(x,start=1,stop=(6-nchar(cons000300[,1])))
y<-paste(cons000300[,1],x)
y
y<-paste(x,cons000300[,1],sep='')
y
y<-paste('sh',y,sep='')
y
y<-paste('-sh',y[2:118],sep='')
y
y<-paste(-'shsh',y[2:118],sep='')
y<-paste(x,cons000300[,1],sep='')
y
rep('sz',118)
z<-rep('sh',182)
z<-(rep('sz',118)+z)
z<-c(rep('sz',118),z)
z
x
y
stock_list <- paste(z,y,sep='')
stock_list
stock_url <- paste(stock_list,sep=',')
stock_url
paste(stock_url,collapes)
paste(stock_url,collapse)
paste(stock_url,collapse=',')
bass_address <- http://hq.sinajs.cn/list=
bass_address <- 'http://hq.sinajs.cn/list='
base_address <- 'http://hq.sinajs.cn/list='
base_address
url_address <- paste(base_address,paste(stock_url,collapse=','),sep='')
url_address
download.file(url, 'all.csv', quiet = TRUE)
download.file(url_address, 'all.csv', quiet = TRUE)
readLines(url_address, 'all.csv', quiet = TRUE)
readLines(url_address, 'all.csv')
readLines(con=url_address)
all_info <- readline(con = url_address)
url_address
all_info <- readline(con = url_address)
readline(con = url_address)
all_info <- readlines(con = url_address)
all_info <- readLines(con = url_address)
all_
View(all)
View(all_info)
all_info[1,1]
all_info[1,1]
all_info[,1]
all_info
all_info{1}
all_info[1]
all_info<-strsplit(all_info,split=',')
all_info
View(all_info)
stock_list[1]
current_price<-all_info[4,]
typeof(all_info)
class(all_info)
class(all_info[1])
current_price<-all_info[[,],4]
current_price<-all_info[[],4]
current_price<-all_info[][4]
current_price
current_price<-all_info[1:300][4]
current_price
View(temp_earning)
View(temp_earning)[1]
all_info[1]
all_info[2]
all_info[][1]
all_info[[]][]1
all_info[[]][1]
all_info[[1]]
all_info[[2]]
all_info[[1]][4]
all_info[[]][4]
sapply(all_info,function(x) x[[4]])
sapply(all_info, function(x))
sapply(all_info, function(x), x[[4]])
sapply(all_info, function(x) x[[4]])
stock_price <- sapply(all_info, function(x) x[[4]])
stock_price
stock_weight<-read.csv('000300closeweight.csv',header=T)
stock_weight<-stock_weight[,7]
stock_weight
nrow(stock_price)
lrow(stock_price)
ncol(stock_price)
range(stock_price)
length(stock_price)
length(stock_weight)
stock_index<-(stock_price*stock_weight)
stock_price <- as.double(stock_price)
stock_price
stock_index<-(stock_price*stock_weight)
stock_index
sum_index<-sum(stock_index)
sum_index
2*sum_index
whoAmI <- function(x, ...) UseMethod("")
whoAmI <- function(x, ...) UseMethod("wh")
whoAmI <- function(x, ...) UseMethod("whoAmI")
whoAmI.foo <- function(x) print('I am a foo')
a <- 1:2
a
class(a)
attr(a,'class')<-'foo'
class(a)
whoAmI(a)
whoAmI(b)
whoAmI(name)
install.packages('Rcurl')
install.packages('RCurl')
library(RCurl)
source('query_PE_test.r')
source('query_PE_test.r')
source('query_PE_test.r')
pretty(all_info)
pretty(all_info[[1]])
all_info[[1]]
require(ggplot2)
require('ggplot2')
install.packages('ggplot2')
require(ggplot2)
ls.objects()
.ls.objects()
.ls.objects <- function (pos = 1, pattern, order.by,
decreasing=FALSE, head=FALSE, n=5) {
napply <- function(names, fn) sapply(names, function(x)
fn(get(x, pos = pos)))
names <- ls(pos = pos, pattern = pattern)
obj.class <- napply(names, function(x) as.character(class(x))[1])
obj.mode <- napply(names, mode)
obj.type <- ifelse(is.na(obj.class), obj.mode, obj.class)
obj.size <- napply(names, object.size)
obj.dim <- t(napply(names, function(x)
as.numeric(dim(x))[1:2]))
vec <- is.na(obj.dim)[, 1] & (obj.type != "function")
obj.dim[vec, 1] <- napply(names, length)[vec]
out <- data.frame(obj.type, obj.size, obj.dim)
names(out) <- c("Type", "Size", "Rows", "Columns")
if (!missing(order.by))
out <- out[order(out[[order.by]], decreasing=decreasing), ]
if (head)
out <- head(out, n)
out
}
.ls.objects(order.by='Size')
.ls.objects(order.by='Size',decreasing=F)
Rprof()
summaryRprof()
re(all_info)
rm(all_info)
.ls.objects(order.by='Size',decreasing=F)
sleep
data(sleep,package='VIM')
sleep
complete.cases(sleep)
sleep[complete.cases(sleep),]
sleep[!complete.cases(sleep),]
nrow(sleep[!complete.cases(sleep),])
mean(sleep[!complete.cases(sleep),])
(sleep[!complete.cases(sleep),])
complete.cases(sleep)
mean(complete.case(sleep))
mean(complete.cases(sleep))
sum
(complete.cases(sleep))
sum(complete.cases(sleep))
is.na(sleep)
is.na(sleep$Dream)
mean(is.na(sleep$Dream))
library(mice)
data(sleep,package='VIM')
sleep
md.pattern(sleep)
aggr(sleep,prop=F,numbers=T)
library('VIM')
aggr(sleep,prop=F,numbers=T)
aggr(sleep,prop=F,numbers=F)
aggr(sleep,prop=F,numbers=T)
matrixplot(sleep)
matrixplot(sleep)
marginplot(sleep)
marginplot(sleep[c('Gest','Dream')],pch=c(20),col=c('darkgrey','red','blue'))
sleep
newdata<-na.omit(sleep)
newdata
newdata<-sleep[complete.cases(sleep),]
newdata
options(digits = 1)
cor(newdata)
source('query_PE_test.r')
result
result
source('query_PE_test.r')
filename<-paste('600000','.csv',sep='')
filename
stockID<-'600000'
stockID<-600000
source('query_PE_test.r')
filename
as.character.octmode(stockID)
stockID
as.character.octmode(stockID)
source('query_Stocks.r')
source('dataCleaning_stock.r')
missing_data
cat('There are totally',total_naNum[,'dataDate'],' NA value in PE for all stocks \n',sep='')
cat('There are ',sum(naStatus),' NA value in PE for the stock ',stockID,'\n',
'missing the data in',missing_data[,'dataDate'],'\n',sep='')
cat('There are ',sum(naStatus),' NA value in PE for the stock ',stockID,'\n',
'missing the data in ',paste(missing_data[,'dataDate'],sep=','),'\n',sep='')
paste(missing_data[,'dataDate'],sep=','
)
paste(missing_data[,'dataDate'],sep=' ')
paste(missing_data[,'dataDate'],sep='and')
paste(as.character(missing_data[,'dataDate']),sep=' ')
class(missing_data)
missing_data['dataDate']
paste(as.character(missing_data['dataDate']),sep=' ')
paste(missing_data['dataDate'],sep=' ')
cat('There are ',sum(naStatus),' NA value in PE for the stock ',stockID,'\n',
'missing the data in ',paste(as.character(missing_data['dataDate']),sep=' '),'\n',sep
)
cat('There are ',sum(naStatus),' NA value in PE for the stock ',stockID,'\n',
'missing the data in ',paste(as.character(missing_data['dataDate']),sep=' '),'\n',sep='')
source('dataCleaning_stock.r')
source('dataCleaning_stock.r')
name
source('dataCleaning_stock.r')
name
stock_list
stock_list <- read.csv(stock_list_file,header=T,stringsAsFactors=F,colClasses='character')[,1]
stock_list
source('dataCleaning_stock.r')
source('dataCleaning_stock.r')
source('dataCleaning_stock.r')
rm(list=ls())
source('dataChecking_stock.r')
source('dataChecking_stock.r')
source('sina.r')
cntrade(tickers = 000001,start=20140909,end=20140909)
cntrade(tickers = 000001,start=20140909,end=20140910)
cntrade(tickers = 000001,start=20140909,end=20140910)
cntrade(tickers = 000001,start=20140909,end=20140912)
cntrade(tickers = 000001,start=20140909,end=20140912)
stock_list <- read.csv(stock_list_file,header=T,stringsAsFactors=F,colClasses='character')[,1]
stock_list
stock_list_file <- '000300cons.csv'
stock_list <- read.csv(stock_list_file,header=T,stringsAsFactors=F,colClasses='character')[,1]
stock_list
source('query_stock.r')
source('query_Stocks.r')
source('query_Stocks.r')
setwd('C:\\Users\\Jianyu.Ye\\Documents\\GitHub\\PEtest')
getwd()
stock_list_file <- '000300cons.csv'
stock_list <- read.csv(stock_list_file,header=T,stringsAsFactors=F,colClasses='character')[,1]
stock_list
stock_list
stock_list <- read.csv(stock_list_file,header=T,stringsAsFactors=F,colClasses='character')[,1]
stock_list <- read.csv(stock_list_file,header=T,stringsAsFactors=F,colClasses='character')[,1]
stock_list
readLines
edit(stock_list)
readline()
teststring <- readline()
teststring
httpheader <- c("Authorization"="Bearer 8aef3c023b90a3d71f24c8544ada4a20c59b5cbc44cc84636755d94f4c8d4e28")
httpheader
View(httpheader)
httpheader <- c("Authorization"=c("Bearer ",readline()))
httpheader
cat('Please update the datayes access token\n')
httpheader <- c("Authorization"=c("Bearer ",readline()))
httpheader
View(httpheader)
httpheader <- c("Authorization"=paste("Bearer ",readline(),sep=''))
View(httpheader)
source('query_Stocks.r')
